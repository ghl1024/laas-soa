思路: 在效率、覆盖面上选择大型供应商专门做周期长的、要求覆盖面广的扫描, 在高效、定向上选择而轻量级的自我扫描

# 存储(存储时)

## 横向

未知文件

iops

存储量

文件数量、层级

文件数据泄露(docker regitry)

员工文档泄露、丢失

文件加密, 分发app反编译

文件多重备份并加密

日志脱敏(替换、删减、去特征/关联性)

## 纵向

私有云vmware/虚拟机磁盘

阿里云ECS磁盘

OSS、DBS

# 网络(传输时)

## 横向

网络阻塞(DDOS、CC)、爬虫、恶意替换为高流量网站被点击目标

域名劫持、流量包劫持(https)、ARP劫持

Nginx、OpenResty、Tomcat/Netty漏洞、网络框架库

CSRF

异常 出口/入口网络请求(Iptables)

Iptables、selinux

接口鉴权

接口防重

接口参数加密, 前端代码加密

接口加签(使用混淆js对特定数据进行加密, 请求服务时携带该加密数据作为参数标签)

数据处理逻辑后置

用户行为分析

验证码

访问环境监测

关闭生产环境api文档

网络隔离

网关监听范围过大

限流

redis等默认端口问题

流量分析

数据安全

图片水印

重要数据禁止复制黏贴、下载

## 纵向

### 客户端

客户端hosts文件

客户端DNS地址

客户端网络设备

### 运营商

运营商网络传输

### 服务器

服务器外层接入网络设施



# 计算(运行时)

## 横向

层层隔离



异常进程: 

​	僵尸进程、大量高耗进程、异常动作、无意义

​	第三方库、程序代码、中间件、镜像

异常定时任务、容器

异常SQL指令

接口鉴权

SQL注入、参数注入、XSS、文件包含、恶意文件上传/执行



操作系统版本漏洞: 主机、容器

默认登录信息重置加固

用户-密码型登录被爆破枚举

生产环境开启了调试模式

用户授权过大

构建时[代码、镜像]的[依赖库、父镜像]扫码

部署包中直接包含git/svc信息, 使用.gitignore, 排除需要排除的文件



k8s中pod权限过大, k8s中敏感信息被意外获取, k8s中网络隔离

配置与代码分离

能不用root启动的就不用root

不用/少用有安全隐患的软件



接口参数校验

驱动执行SQL时使用预编译, 禁止字符串替换, 动态SQL使用模板引擎渲染

## 纵向



# 展示

客户电脑广告弹窗

浏览器、内嵌网页 恶意植入/篡改

# 运维

执行指令前再次确定是需要/能操作的服务器/服务, 执行执行前先检测是否有问题, 变更高等级环境前先去低等级环境试验

登录工具、方式

​	禁用密码登录, 使用公钥登录

​	明确跳板机安全

登录账号粒度最小化, 禁止共用

公共账号和个人账号分离

操作工具

执行指令

文件授权

sudo 授权过大

登录信息[文件]随意存放会泄露、丢失

定期漏洞扫描、登录信息修改

定期演练(混沌)

版本管理脚本/执行, 代码包, 文件

部署环境隔离

脚本指令中对数据进行脱敏

## 禁止几个情况

- 严禁酒后登录线上服务器操作
- 严禁在载具上登录线上服务器操作
- 严禁吵架后情绪激动登录线上服务器操作
- 严禁长时间加班后操作线上环境
- 禁止在线上试验不熟悉的命令
- 重要系统操作前先做备份, 执行指令时使用带有备份选项



# 研发

内部敏感代码[登录、授权系统]禁止提交到外部

使用官方软件、官方仓库、官方代理

执行exe文件、打开文档前注意电脑管	家是运行状态, 谨慎

长时间离开电脑前时锁屏, 电脑设置登录密码/PIN/指纹/距离感应

分目录存放文件



- 严禁酒后修改核心代码并提交
- 严禁在载具上修改核心代码并提交
- 严禁吵架后情绪激动修改核心代码并提交
- 严禁长时间加班后修改核心代码并提交
- 禁止不经测试上线代码
- 核心代码上线前先做备份, 核心代码上线后尽量兼容原数据库