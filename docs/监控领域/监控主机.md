监控目标

```
192.168.5.38
192.168.5.35
192.168.4.209
192.168.2.244
192.168.5.225
192.168.2.35
192.168.3.126
192.168.3.124
192.168.3.15
192.168.3.14
192.168.3.13
192.168.2.19
192.168.2.18
192.168.2.17
192.168.2.34
192.168.3.125
192.168.2.32
192.168.2.31
192.168.3.12
192.168.3.11
192.168.3.10
192.168.2.16
192.168.2.8
192.168.2.7
192.168.2.20
192.168.2.21
192.168.3.9
192.168.3.5
192.168.2.10
192.168.5.4
192.168.3.3
192.168.3.1
192.168.3.2
192.168.2.3
192.168.2.2
192.168.2.240
192.168.2.15
192.168.3.6
192.168.2.13
192.168.3.107
192.168.4.201
192.168.2.11
192.168.2.4
192.168.2.1
192.168.2.12


192.168.2.6
192.168.2.5
192.168.5.3
192.168.3.100
```



初始化manager



```
# 初始化目录
mkdir -p /data/tristan/exporter/node_exporter && chmod 777 /data/tristan/exporter/node_exporter
cd /data/tristan/exporter/node_exporter

# 安装sshpass
sudo yum install -y epel-release
sudo yum repolist
sudo yum install -y sshpass

# 初始化exporter文件
wget https://github.com/prometheus/node_exporter/releases/download/v1.0.1/node_exporter-1.0.1.linux-amd64.tar.gz
tar -zvxf node_exporter-1.0.1.linux-amd64.tar.gz
cp node_exporter-1.0.1.linux-amd64/node_exporter node_exporter

# 准备好安装脚本和目标主机和密码

```



调整scrape

```

```



/usr/lib/systemd/system/node_exporter.service

```
 [Unit]
 Description=Prometheus Node Exporter
 Wants=network-online.target
 After=network-online.target

 [Service]
 User=node_exporter
 Group=node_exporter
 Type=simple

 ExecStart=/opt/node_exporter/node_exporter --web.listen-address=0.0.0.0:9100 --log.level=info --log.format=json --collector.logind --collector.systemd --collector.tcpstat --collector.ntp --collector.interrupts  --collector.meminfo_numa --collector.processes --no-collector.bonding --no-collector.bcache --no-collector.arp --no-collector.edac --no-collector.infiniband --no-collector.ipvs --no-collector.mdadm --no-collector.nfs --no-collector.nfsd --no-collector.textfile --no-collector.wifi --no-collector.hwmon --no -collector.conntrack --no-collector.timex --no-collector.zfs --collector.systemd.unit-whitelist=(crond|sshd|node_exporter)\\.service

 ExecReload=/bin/kill -HUP $MAINPID
 TimeoutStopSec=10s
 SendSIGKILL=no
 SyslogIdentifier=prometheus_node_exporter
 Restart=always

 [Install]
 WantedBy=multi-user.target
```