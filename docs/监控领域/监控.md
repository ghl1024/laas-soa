基于主机: 192.168.2.21

# prometheus

安装

```
rm -rf /data/tristan/prometheus
mkdir -p  /data/tristan/prometheus && chmod 777 /data/tristan/prometheus
mkdir -p  /data/tristan/prometheus/data && chmod 777 /data/tristan/prometheus/data
sudo tee /data/tristan/prometheus/prometheus.yml <<-'EOF'
global:
  scrape_interval:     15s
  evaluation_interval: 15s
alerting:
  alertmanagers:
  - static_configs:
    - targets:
rule_files:
scrape_configs:
  - job_name: 'prometheus'
    static_configs:
    - targets: ['localhost:9090']
EOF

docker sotp prometheus && docker rm prometheus
docker run -d \
  --name=prometheus \
  --restart=always \
  -p 9090:9090 \
  -v /data/tristan/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml \
  -v /data/tristan/prometheus/data:/prometheus \
  prom/prometheus:v2.23.0
  
docker logs -f --tail=100 prometheus
```



# grafana

安装

```
rm -rf /data/tristan/grafana
mkdir -p /data/tristan/grafana/configs /data/tristan/grafana/data
chmod 777 /data/tristan/grafana/configs /data/tristan/grafana/data

docker stop grafana && docker rm grafana
docker run -d \
  --name=grafana \
  --restart=always \
  -p 80:3000 \
  -v /data/tristan/grafana/data:/var/lib/grafana \
  grafana/grafana:7.3.4

docker logs -f --tail=100 grafana
```

添加数据源



# exporter

node_exporter

redis

zookeeper